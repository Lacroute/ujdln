<template>
  <div>
    <div v-if="begin" transition="fade" class="animated" transition-mode="out-in" v-el:test>
      <blackscreen
          v-for="blackscreen in bs"
          :blackscreen="blackscreen"
          @end-blackscreen="removeBlackscreen">
      </blackscreen>

      <!-- <span v-el:msga>hello</span> -->
    </div>

    <div v-if="next" transition="fade" class="animated">
      <!-- <span v-el:msgg>world</span> -->
      <sequence @end-sequence="nextSequence"></sequence>
      <continue msg="Go back to Intro" target="/intro"></continue>
    </div>
  </div>
</template>

<script>
import Blackscreen from './Blackscreen.vue'
import Sequence from './Sequence.vue'
import Continue from './Continue.vue'

export default {
  name: 'Home',

  components: {Blackscreen, Sequence, Continue},

  data () {
    return {
      begin: true,
      next: false,
      bs: [],
      seq: []
    }
  },

  ready: function(){
    this.bs.push({text: "Texte d'introduction de la seconde s√©quence."});
  },

  methods: {
    removeBlackscreen: function(blackscreen){
      let test = this.$els.test
      let that = this
      let animations = ['animationend', 'webkitAnimationEnd', 'oAnimationEnd', 'MSAnimationEnd']

      animations.forEach(function(anim) {
          test.addEventListener(anim, function(){
            console.log('animation ended')
            that.next = true;
          }, false)
      })
      
      this.begin = false;
    },

    nextSequence: function(){
      console.log('end-sequence')
    }
  }
}
</script>
